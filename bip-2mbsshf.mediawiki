<pre>
  BIP: ?
  Layer: Consensus (hard fork)
  Title: Post-segwit 2 MB block size hardfork
  Author: FIXME
  Comments-Summary: No comments yet.
  Comments-URI: ?
  Status: Draft
  Type: Standards Track
  Created: 2017-05-22
  License: BSD-2-Clause
</pre>

==Abstract==

Legacy Bitcoin transactions are given the witness discount, and a block size limit of 2 MB is imposed.

==Copyright==

This BIP is licensed under the BSD 2-clause license.

==Specification==

Upon activation, a block size limit of 2000000 bytes is enforced.
The block weight limit remains at 4000000 WU.

The calculation of block weight is modified:
all witness data, including both scriptSig (used by pre-segwit inputs) and segwit witness data, is measured as 1 weight-unit (WU), while all other data in the block is measured as 4 WU.

The transaction-id merkle root hash in the block header is replaced with a new merkle tree built on leaves that consist of a hash of:

1. A hash of the entire transaction.
2. The transaction id.

The witness commitment in the generation transaction is replaced with a new merkle tree built on leaves that consist of a hash of:

1. The witness reserved value.
2. A hash of the entire transaction.

Except that for the generation transaction, the witness reserved value is the entire leaf.

The maximum size of a transaction stripped of witness data is limited to 1 MB.

===Deployment===

This BIP is deployed by flag day, in the block where the median-past time surpasses 1543503872 (2018 Nov 29 at 15:04:32 UTC).

It is assumed that when this flag day has been reached, Segwit has been activated via BIP141 and/or BIP148.

==Motivation==

FIXME

==Rationale==

FIXME

==Backwards compatibility==

This is a hardfork, and as such not backward compatible.
It should not be deployed without consent of the entire Bitcoin community.
Activation is scheduled for 18 months from the creation date of this BIP, intended to give 6 months to establish consensus, and 12 months for deployment.

==Reference implementation==

FIXME
